<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Discrete power-law distribution — dpldis • poweRlaw</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Discrete power-law distribution — dpldis"><meta name="description" content="Density, distribution function and random number generation
for the discrete power law distribution with parameters xmin and alpha."><meta property="og:description" content="Density, distribution function and random number generation
for the discrete power law distribution with parameters xmin and alpha."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">poweRlaw</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csgillespie/poweRlaw/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Discrete power-law distribution</h1>
      <small class="dont-index">Source: <a href="https://github.com/csgillespie/poweRlaw/blob/main/R/pldis.R" class="external-link"><code>R/pldis.R</code></a></small>
      <div class="d-none name"><code>dpldis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Density, distribution function and random number generation
for the discrete power law distribution with parameters xmin and alpha.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dpldis</span><span class="op">(</span><span class="va">x</span>, <span class="va">xmin</span>, <span class="va">alpha</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ppldis</span><span class="op">(</span><span class="va">q</span>, <span class="va">xmin</span>, <span class="va">alpha</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rpldis</span><span class="op">(</span><span class="va">n</span>, <span class="va">xmin</span>, <span class="va">alpha</span>, discrete_max <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x-q">x, q<a class="anchor" aria-label="anchor" href="#arg-x-q"></a></dt>
<dd><p>vector of quantiles. The discrete
power-law distribution is defined for x &gt; xmin.</p></dd>


<dt id="arg-xmin">xmin<a class="anchor" aria-label="anchor" href="#arg-xmin"></a></dt>
<dd><p>The lower bound of the power-law distribution.
For the continuous power-law, xmin &gt;= 0.
for the discrete distribution, xmin &gt; 0.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The scaling parameter: alpha &gt; 1.</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p>logical (default FALSE) if TRUE, log values are returned.</p></dd>


<dt id="arg-lower-tail">lower.tail<a class="anchor" aria-label="anchor" href="#arg-lower-tail"></a></dt>
<dd><p>logical;
if TRUE (default), probabilities are \(P[X \le x]\),
otherwise, \(P[X &gt; x]\).</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of observations. If <code>length(n) &gt; 1</code>, the length is
taken to be the number required.</p></dd>


<dt id="arg-discrete-max">discrete_max<a class="anchor" aria-label="anchor" href="#arg-discrete-max"></a></dt>
<dd><p>The value when we switch from the discrete random
numbers to a CTN approximation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>dpldis returns the density, ppldis returns the distribution function
and rpldis return random numbers.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Clauset, 2009 paper provides an algorithm for generating discrete random numbers.
However, if this algorithm is implemented in R, it gives terrible performance.
This is because the algorithm involves "growing vectors".
Another problem is when alpha is close to 1, this can result in very large random
number being generated (which means we need
to calculate the discrete CDF for very large values).</p>
<p>The algorithm provided in this package generates true
discrete random numbers up to 10,000 then switches to
using continuous random numbers. This switching point can altered by
changing the <code>discrete_max</code> argument.</p>
<p>In order to get a efficient power-law discrete random number generator, the
algorithm needs to be implemented in C.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The naming of these functions mirrors standard R functions, i.e. dnorm.
When alpha is close to one, generating random number can be very slow.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Clauset, Aaron, Cosma Rohilla Shalizi, and Mark EJ Newman.
"Power-law distributions in empirical data." SIAM review 51.4 (2009): 661-703.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">xmin</span> <span class="op">=</span> <span class="fl">1</span>; <span class="va">alpha</span> <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="va">xmin</span><span class="op">:</span><span class="fl">100</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">dpldis</span><span class="op">(</span><span class="va">x</span>, <span class="va">xmin</span>, <span class="va">alpha</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="dpldis-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">ppldis</span><span class="op">(</span><span class="va">x</span>, <span class="va">xmin</span>, <span class="va">alpha</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">"Distribution function"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="dpldis-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">dpldis</span><span class="op">(</span><span class="fl">1</span>, <span class="va">xmin</span>, <span class="va">alpha</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6079271</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###############################################</span></span></span>
<span class="r-in"><span><span class="co">## Random number generation                   #</span></span></span>
<span class="r-in"><span><span class="co">###############################################</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">1e5</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">=</span> <span class="fu">rpldis</span><span class="op">(</span><span class="va">n</span>, <span class="va">xmin</span>, <span class="va">alpha</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Compare with exact (dpldis(1, xmin, alpha))</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x1</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">n</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.60889</span>
<span class="r-in"><span><span class="co">## Using only the approximation</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">=</span> <span class="fu">rpldis</span><span class="op">(</span><span class="va">n</span>, <span class="va">xmin</span>, <span class="va">alpha</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x2</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">n</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.66452</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Colin Gillespie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

