<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimating the lower bound (xmin) — get_bootstrap_sims • poweRlaw</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating the lower bound (xmin) — get_bootstrap_sims"><meta name="description" content="When fitting heavy tailed distributions, sometimes it
is necessary to estimate the lower threshold, xmin. The
lower bound is estimated by minimising the
Kolmogorov-Smirnoff statistic
(as described in Clauset, Shalizi, Newman (2009)).
get_KS_statistic
Calculates the KS statistic for a particular value of xmin.

estimate_xmin
Estimates the optimal lower cutoff using a
goodness-of-fit based approach. This function may issue warnings
when fitting lognormal, Poisson or Exponential distributions. The
warnings occur for large values of xmin. Essentially, we are discarding
the bulk of the distribution and cannot calculate the tails to enough
accuracy.

bootstrap
Estimates the uncertainty in the xmin and parameter values
via bootstrapping.

bootstrap_p
Performs a bootstrapping hypothesis test to determine
whether a suggested
(typically power law) distribution is plausible. This is only available for distributions that
have dist_rand methods available.


"><meta property="og:description" content="When fitting heavy tailed distributions, sometimes it
is necessary to estimate the lower threshold, xmin. The
lower bound is estimated by minimising the
Kolmogorov-Smirnoff statistic
(as described in Clauset, Shalizi, Newman (2009)).
get_KS_statistic
Calculates the KS statistic for a particular value of xmin.

estimate_xmin
Estimates the optimal lower cutoff using a
goodness-of-fit based approach. This function may issue warnings
when fitting lognormal, Poisson or Exponential distributions. The
warnings occur for large values of xmin. Essentially, we are discarding
the bulk of the distribution and cannot calculate the tails to enough
accuracy.

bootstrap
Estimates the uncertainty in the xmin and parameter values
via bootstrapping.

bootstrap_p
Performs a bootstrapping hypothesis test to determine
whether a suggested
(typically power law) distribution is plausible. This is only available for distributions that
have dist_rand methods available.


"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">poweRlaw</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csgillespie/poweRlaw/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimating the lower bound (xmin)</h1>
      <small class="dont-index">Source: <a href="https://github.com/csgillespie/poweRlaw/blob/v1.0.0/R/bootstrap.R" class="external-link"><code>R/bootstrap.R</code></a>, <a href="https://github.com/csgillespie/poweRlaw/blob/v1.0.0/R/bootstrap_p.R" class="external-link"><code>R/bootstrap_p.R</code></a>, <a href="https://github.com/csgillespie/poweRlaw/blob/v1.0.0/R/estimate_xmin.R" class="external-link"><code>R/estimate_xmin.R</code></a></small>
      <div class="d-none name"><code>estimate_xmin.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>When fitting heavy tailed distributions, sometimes it
is necessary to estimate the lower threshold, xmin. The
lower bound is estimated by minimising the
Kolmogorov-Smirnoff statistic
(as described in Clauset, Shalizi, Newman (2009)).</p><dl><dt><code>get_KS_statistic</code></dt>
<dd><p>Calculates the KS statistic for a particular value of xmin.</p></dd>

<dt><code>estimate_xmin</code></dt>
<dd><p>Estimates the optimal lower cutoff using a
goodness-of-fit based approach. This function may issue <code>warnings</code>
when fitting lognormal, Poisson or Exponential distributions. The
warnings occur for large values of <code>xmin</code>. Essentially, we are discarding
the bulk of the distribution and cannot calculate the tails to enough
accuracy.</p></dd>

<dt><code>bootstrap</code></dt>
<dd><p>Estimates the uncertainty in the xmin and parameter values
via bootstrapping.</p></dd>

<dt><code>bootstrap_p</code></dt>
<dd><p>Performs a bootstrapping hypothesis test to determine
whether a suggested
(typically power law) distribution is plausible. This is only available for distributions that
have <code>dist_rand</code> methods available.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_bootstrap_sims</span><span class="op">(</span><span class="va">m</span>, <span class="va">no_of_sims</span>, <span class="va">seed</span>, threads <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bootstrap</span><span class="op">(</span></span>
<span>  <span class="va">m</span>,</span>
<span>  xmins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xmax <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  no_of_sims <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"ks"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_bootstrap_p_sims</span><span class="op">(</span><span class="va">m</span>, <span class="va">no_of_sims</span>, <span class="va">seed</span>, threads <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bootstrap_p</span><span class="op">(</span></span>
<span>  <span class="va">m</span>,</span>
<span>  xmins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xmax <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  no_of_sims <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"ks"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_distance_statistic</span><span class="op">(</span><span class="va">m</span>, xmax <span class="op">=</span> <span class="fl">1e+05</span>, distance <span class="op">=</span> <span class="st">"ks"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">estimate_xmin</span><span class="op">(</span><span class="va">m</span>, xmins <span class="op">=</span> <span class="cn">NULL</span>, pars <span class="op">=</span> <span class="cn">NULL</span>, xmax <span class="op">=</span> <span class="fl">1e+05</span>, distance <span class="op">=</span> <span class="st">"ks"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-m">m<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>A reference class object that contains the data.</p></dd>


<dt id="arg-no-of-sims">no_of_sims<a class="anchor" aria-label="anchor" href="#arg-no-of-sims"></a></dt>
<dd><p>number of bootstrap simulations. When <code>no_of_sims</code> is large, this can
take a while to run.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>default <code>NULL</code>. An integer to be supplied to <code>set.seed</code>, or <code>NULL</code>
not to set reproducible seeds. This argument is passed <code>clusterSetRNGStream</code>.</p></dd>


<dt id="arg-threads">threads<a class="anchor" aria-label="anchor" href="#arg-threads"></a></dt>
<dd><p>number of concurrent threads used during the bootstrap.</p></dd>


<dt id="arg-xmins">xmins<a class="anchor" aria-label="anchor" href="#arg-xmins"></a></dt>
<dd><p>default <code>1e5</code>. A vector of possible values
of xmin to explore. When a single value is passed, this represents
the maximum value to search, i.e. by default we search from
(1, 1e5). See details for further information.</p></dd>


<dt id="arg-pars">pars<a class="anchor" aria-label="anchor" href="#arg-pars"></a></dt>
<dd><p>default <code>NULL</code>. A vector or matrix (number of columns equal
to the number of parameters) of parameters used to #' optimise over.
Otherwise, for each value of <code>xmin</code>, the mle will be used, i.e. <code>estimate_pars(m)</code>.
For small samples, the mle may be biased.</p></dd>


<dt id="arg-xmax">xmax<a class="anchor" aria-label="anchor" href="#arg-xmax"></a></dt>
<dd><p>default <code>1e5</code>. The maximum x value calculated when working out the CDF.
See details for further
information.</p></dd>


<dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>A string containing the distance measure (or measures) to calculate.
Possible values are <code>ks</code> or <code>reweight</code>. See details for further information.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When estimating <code>xmin</code> for discrete distributions, the search space when
comparing the data-cdf (empirical cdf)
and the distribution_cdf runs from xmin to <code>max(x)</code>
where <code>x</code> is the data set. This <strong>can</strong> often be
computationally brutal. In particular, when bootstrapping
we generate random numbers from the power law distribution,
which has a long tail.</p>
<p>To speed up computations for discrete distributions it is sensible to put an
upper bound, i.e. <code>xmax</code> and/or explicitly give values of where to search, i.e. <code>xmin</code>.</p>
<p>Occasionally bootstrapping can generate strange situations. For example,
all values in the simulated data set are less then <code>xmin</code>. In this case,
the estimated distance measure will be <code>Inf</code> and the parameter values, <code>NA</code>.</p>
<p>There are other possible distance measures that can be calculated. The default is the
Kolomogorov Smirnoff statistic (<code>KS</code>). This is equation 3.9 in the CSN paper. The
other measure currently available is <code>reweight</code>, which is equation 3.11.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Adapted from Laurent Dubroca's code</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">###################################################</span></span></span>
<span class="r-in"><span><span class="co"># Load the data set and create distribution object#</span></span></span>
<span class="r-in"><span><span class="co">###################################################</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="va"><a href="displ.html">displ</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###################################################</span></span></span>
<span class="r-in"><span><span class="co"># Estimate xmin and pars                          #</span></span></span>
<span class="r-in"><span><span class="co">###################################################</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">=</span> <span class="fu">estimate_xmin</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">$</span><span class="fu">setXmin</span><span class="op">(</span><span class="va">est</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###################################################</span></span></span>
<span class="r-in"><span><span class="co"># Bootstrap examples                              #</span></span></span>
<span class="r-in"><span><span class="co">###################################################</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">bootstrap</span><span class="op">(</span><span class="va">m</span>, no_of_sims<span class="op">=</span><span class="fl">1</span>, threads<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">bootstrap_p</span><span class="op">(</span><span class="va">m</span>, no_of_sims<span class="op">=</span><span class="fl">1</span>, threads<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Colin Gillespie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

